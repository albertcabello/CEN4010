{"ast":null,"code":"module.exports = ErrorPacket;\n\nfunction ErrorPacket(options) {\n  options = options || {};\n  this.fieldCount = options.fieldCount;\n  this.errno = options.errno;\n  this.sqlStateMarker = options.sqlStateMarker;\n  this.sqlState = options.sqlState;\n  this.message = options.message;\n}\n\nErrorPacket.prototype.parse = function (parser) {\n  this.fieldCount = parser.parseUnsignedNumber(1);\n  this.errno = parser.parseUnsignedNumber(2); // sqlStateMarker ('#' = 0x23) indicates error packet format\n\n  if (parser.peak() === 0x23) {\n    this.sqlStateMarker = parser.parseString(1);\n    this.sqlState = parser.parseString(5);\n  }\n\n  this.message = parser.parsePacketTerminatedString();\n};\n\nErrorPacket.prototype.write = function (writer) {\n  writer.writeUnsignedNumber(1, 0xff);\n  writer.writeUnsignedNumber(2, this.errno);\n\n  if (this.sqlStateMarker) {\n    writer.writeString(this.sqlStateMarker);\n    writer.writeString(this.sqlState);\n  }\n\n  writer.writeString(this.message);\n};","map":null,"metadata":{},"sourceType":"script"}